root@79d893fd8ed0:/app/logs# cat vuln_scan_results_20240526_053925.txt [2024-05-26 05:39:25.624276] Scanning URL: https://wallet.zksync.io [2024-05-26 05:39:25.624416] Running Nmap scan on https://wallet.zksync.io Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 05:39 UTC Unable to split netmask from target expression: "https://wallet.zksync.io" WARNING: No targets were specified, so 0 hosts scanned. Nmap done: 0 IP addresses (0 hosts up) scanned in 0.12 seconds [2024-05-26 05:39:25.756532] Running Nikto scan on https://wallet.zksync.io - Nikto v2.1.5 --------------------------------------------------------------------------- + ERROR: Cannot resolve hostname 'wallet.zksync.io' + 0 host(s) tested [2024-05-26 05:39:26.098709] Running SSL scan on https://wallet.zksync.io ERROR: Could not resolve hostname wallet.zksync.io. Version: 2.1.2 OpenSSL 3.0.13 30 Jan 2024 [2024-05-26 05:39:26.123813] Completed scanning URL: https://wallet.zksync.io [2024-05-26 05:39:26.123916] Scanning URL: https://zkscan.io [2024-05-26 05:39:26.123973] Running Nmap scan on https://zkscan.io Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 05:39 UTC Unable to split netmask from target expression: "https://zkscan.io" WARNING: No targets were specified, so 0 hosts scanned. Nmap done: 0 IP addresses (0 hosts up) scanned in 0.13 seconds [2024-05-26 05:39:26.261763] Running Nikto scan on https://zkscan.io - Nikto v2.1.5 --------------------------------------------------------------------------- + Target IP: 199.36.158.100 + Target Hostname: zkscan.io + Target Port: 443 --------------------------------------------------------------------------- + SSL Info: Subject: /CN=firebaseapp.com Ciphers: TLS_AES_128_GCM_SHA256 Issuer: /C=US/O=Google Trust Services/CN=WR4 + Start Time: 2024-05-26 05:39:26 (GMT0) --------------------------------------------------------------------------- + Server: No banner retrieved + Retrieved x-served-by header: cache-pao-kpao1770049-PAO + Server leaks inodes via ETags, header found with file /, fields: 0x314e8cda6d32e4e54bf6d92e8fad5a3a829a37ead09f48b296f20f64dd6b1368 + The anti-clickjacking X-Frame-Options header is not present. + Uncommon header 'x-timer' found, with contents: S1716701966.299109,VS0,VE0 + Uncommon header 'x-cache' found, with contents: HIT + Uncommon header 'strict-transport-security' found, with contents: max-age=31556926 + Uncommon header 'x-served-by' found, with contents: cache-pao-kpao1770049-PAO + Uncommon header 'alt-svc' found, with contents: h3=":443";ma=86400,h3-29=":443";ma=86400,h3-27=":443";ma=86400 + Uncommon header 'x-cache-hits' found, with contents: 8 + No CGI Directories found (use '-C all' to force check all possible dirs) + Hostname 'zkscan.io' does not match certificate's CN 'firebaseapp.com' + Allowed HTTP Methods: GET, HEAD, OPTIONS + Uncommon header 'referrer-policy' found, with contents: no-referrer + Uncommon header 'x-content-type-options' found, with contents: nosniff + Uncommon header 'x-frame-options' found, with contents: SAMEORIGIN + Uncommon header 'x-xss-protection' found, with contents: 0 + OSVDB-3092: /js: This might be interesting... + 6544 items checked: 0 error(s) and 16 item(s) reported on remote host + End Time: 2024-05-26 05:46:52 (GMT0) (446 seconds) --------------------------------------------------------------------------- + 1 host(s) tested [2024-05-26 05:46:52.230413] Running SSL scan on https://zkscan.io Version: 2.1.2 OpenSSL 3.0.13 30 Jan 2024 Connected to 199.36.158.100 Testing SSL server zkscan.io on port 443 using SNI name zkscan.io SSL/TLS Protocols: SSLv2 disabled SSLv3 disabled TLSv1.0 disabled TLSv1.1 disabled TLSv1.2 enabled TLSv1.3 enabled TLS Fallback SCSV: Server supports TLS Fallback SCSV TLS renegotiation: Session renegotiation not supported TLS Compression: OpenSSL version does not support compression Rebuild with zlib1g-dev package for zlib support Heartbleed: TLSv1.3 not vulnerable to heartbleed TLSv1.2 not vulnerable to heartbleed Supported Server Cipher(s): Preferred TLSv1.3 128 bits TLS_AES_128_GCM_SHA256 Curve 25519 DHE 253 Accepted TLSv1.3 256 bits TLS_AES_256_GCM_SHA384 Curve 25519 DHE 253 Accepted TLSv1.3 256 bits TLS_CHACHA20_POLY1305_SHA256 Curve 25519 DHE 253 Preferred TLSv1.2 256 bits ECDHE-RSA-CHACHA20-POLY1305 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-GCM-SHA256 Curve 25519 DHE 253 Accepted TLSv1.2 256 bits ECDHE-RSA-AES256-GCM-SHA384 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-SHA256 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-SHA Curve 25519 DHE 253 Accepted TLSv1.2 256 bits ECDHE-RSA-AES256-SHA Curve 25519 DHE 253 Accepted TLSv1.2 128 bits AES128-GCM-SHA256 Accepted TLSv1.2 128 bits AES128-SHA Accepted TLSv1.2 256 bits AES256-SHA Server Key Exchange Group(s): TLSv1.3 128 bits secp256r1 (NIST P-256) TLSv1.3 192 bits secp384r1 (NIST P-384) TLSv1.3 128 bits x25519 TLSv1.2 128 bits secp256r1 (NIST P-256) TLSv1.2 192 bits secp384r1 (NIST P-384) TLSv1.2 128 bits x25519 SSL Certificate: Signature Algorithm: sha256WithRSAEncryption RSA Key Strength: 2048 Subject: link.tanamduit.com Altnames: DNS:link.tanamduit.com, DNS:www.markeingsolution.online, DNS:askarchelia.melzo.guru, DNS:www.skunk-team.com, DNS:app.dgeimoveis.com.br, DNS:links.myid-idp.unifiedpost.com, DNS:pandionenergy.parkalot.io, DNS:dev.zagenzagen.nl, DNS:lkarchitektura.pl, DNS:lowenergyconstruction.co.nz, DNS:ondernermers.1hvm.nl, DNS:www.mwbcreps.co.uk, DNS:nst.coleta.relatoweb.com.br, DNS:www.aitopcoder.com, DNS:www.kasisuri.com, DNS:user.1kmwine.com, DNS:cgb.myeasyfarm.com, DNS:www.eclatdebain.fr, DNS:www.niksis.eu, DNS:moemisto.ks.ua, DNS:ionic.socialerp.net, DNS:admin.versesmesek.hu, DNS:staging.databeef.semex.com.br, DNS:parkovani.cesbrod.cz, DNS:www.ohhandy.com, DNS:www.fbtb.se, DNS:bdd.jaceyi.com, DNS:link.atrena.net, DNS:www.suellenmengatto.com.br, DNS:www.write-more.com, DNS:www.planetdeko.hu, DNS:tesla.bluewhale.kr, DNS:www.dgtlwrds.io, DNS:dc.ghdh.vn, DNS:staging.system.resbutler.com, DNS:bezettingstool.moviera.nl, DNS:dev.app.claimconnect.4-sure.net, DNS:www.melhorespratos.com.br, DNS:app.test.bobestyrer.no, DNS:campaign.appsensi.com, DNS:www.atrbrand.com.br, DNS:admin.hyundai.pecas2b.com.br, DNS:www.novcom.co.za, DNS:staging-admin.kegtracker.co.za, DNS:firebase.cdn.blog.pai233.top, DNS:www.quantumroast.com, DNS:web.dannyapp.net, DNS:benjihillard.com, DNS:nll.pw, DNS:gestao.lhbdigital.com.br, DNS:conejo.cl, DNS:www.wendues.com, DNS:dev.the-red-queen.net, DNS:saryam.com, DNS:cms.fuse-on.co, DNS:mumoin.com, DNS:thepioneerplace.com, DNS:gainz.karma.net, DNS:zkscan.io, DNS:fb.worldportal.com.my, DNS:www.blacksmithdata.io, DNS:nantesrezemetropolevolley.deeplinks.bfansports.com, DNS:greenprofitline.in, DNS:www.quesado.com, DNS:minismart.in, DNS:sharezones.in, DNS:productgang.com, DNS:miyauchi.dev, DNS:brianmicklethwaitarchive.org, DNS:www.jacinto.design, DNS:auth.nativepay.io, DNS:www.datacompanies.fr, DNS:www.seasontickets.me, DNS:unlock.zonic.me, DNS:spellcasting.decodedetroit.com, DNS:www.nvwrestling.org, DNS:www.merlynlabs.io, DNS:www.wokytalk.com, DNS:www.posbol.com, DNS:www.legentis.com, DNS:test.virego.app, DNS:app.brandzino.com, DNS:mtgsnap.com, DNS:iasdsantamonica.com, DNS:ensadist.com, DNS:www.weltindia.in, DNS:www.masonreview.com, DNS:masonreview.com, DNS:realtoristic.com, DNS:millennial.dev, DNS:www.danielchristian.dev, DNS:www.viscalc.app, DNS:www.realtoristic.com, DNS:www.bestimate.app, DNS:casaperks.com, DNS:elz.ai, DNS:mulleder.com, DNS:www.ensadist.com, DNS:dobro-powraca.com, DNS:homviz.net Issuer: WR3 Not valid before: May 26 01:03:34 2024 GMT Not valid after: Aug 24 02:02:17 2024 GMT [2024-05-26 05:46:55.753066] Completed scanning URL: https://zkscan.io [2024-05-26 05:46:55.753205] Scanning URL: https://link.zksync.io/ [2024-05-26 05:46:55.753259] Running Nmap scan on https://link.zksync.io/ Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 05:46 UTC Unable to split netmask from target expression: "https://link.zksync.io/" WARNING: No targets were specified, so 0 hosts scanned. Nmap done: 0 IP addresses (0 hosts up) scanned in 0.12 seconds [2024-05-26 05:46:55.886914] Running Nikto scan on https://link.zksync.io/ - Nikto v2.1.5 --------------------------------------------------------------------------- + ERROR: Cannot resolve hostname 'link.zksync.io' + 0 host(s) tested [2024-05-26 05:46:56.249281] Running SSL scan on https://link.zksync.io/ ERROR: Could not resolve hostname link.zksync.io. Version: 2.1.2 OpenSSL 3.0.13 30 Jan 2024 [2024-05-26 05:46:56.280630] Completed scanning URL: https://link.zksync.io/ [2024-05-26 05:46:56.280729] Scanning URL: https://withdraw.zksync.io [2024-05-26 05:46:56.280783] Running Nmap scan on https://withdraw.zksync.io Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 05:46 UTC Unable to split netmask from target expression: "https://withdraw.zksync.io" WARNING: No targets were specified, so 0 hosts scanned. Nmap done: 0 IP addresses (0 hosts up) scanned in 0.12 seconds [2024-05-26 05:46:56.414996] Running Nikto scan on https://withdraw.zksync.io - Nikto v2.1.5 --------------------------------------------------------------------------- + Target IP: 104.18.42.36 + Target Hostname: withdraw.zksync.io + Target Port: 443 + Start Time: 2024-05-26 05:46:56 (GMT0) --------------------------------------------------------------------------- + Server: cloudflare + The anti-clickjacking X-Frame-Options header is not present. + Uncommon header 'cf-ray' found, with contents: - + No CGI Directories found (use '-C all' to force check all possible dirs) + 6544 items checked: 1 error(s) and 2 item(s) reported on remote host + End Time: 2024-05-26 05:55:39 (GMT0) (523 seconds) --------------------------------------------------------------------------- + 1 host(s) tested [2024-05-26 05:55:39.575905] Running SSL scan on https://withdraw.zksync.io Version: 2.1.2 OpenSSL 3.0.13 30 Jan 2024 Connected to 172.64.145.220 Testing SSL server withdraw.zksync.io on port 443 using SNI name withdraw.zksync.io SSL/TLS Protocols: SSLv2 disabled SSLv3 disabled TLSv1.0 disabled TLSv1.1 disabled TLSv1.2 enabled TLSv1.3 enabled TLS Fallback SCSV: Server supports TLS Fallback SCSV TLS renegotiation: Session renegotiation not supported TLS Compression: OpenSSL version does not support compression Rebuild with zlib1g-dev package for zlib support Heartbleed: TLSv1.3 not vulnerable to heartbleed TLSv1.2 not vulnerable to heartbleed Supported Server Cipher(s): Preferred TLSv1.3 128 bits TLS_AES_128_GCM_SHA256 Curve 25519 DHE 253 Accepted TLSv1.3 256 bits TLS_AES_256_GCM_SHA384 Curve 25519 DHE 253 Accepted TLSv1.3 256 bits TLS_CHACHA20_POLY1305_SHA256 Curve 25519 DHE 253 Preferred TLSv1.2 256 bits ECDHE-RSA-CHACHA20-POLY1305 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-GCM-SHA256 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-SHA Curve 25519 DHE 253 Accepted TLSv1.2 128 bits AES128-GCM-SHA256 Accepted TLSv1.2 128 bits AES128-SHA Accepted TLSv1.2 256 bits ECDHE-RSA-AES256-GCM-SHA384 Curve 25519 DHE 253 Accepted TLSv1.2 256 bits ECDHE-RSA-AES256-SHA Curve 25519 DHE 253 Accepted TLSv1.2 256 bits AES256-GCM-SHA384 Accepted TLSv1.2 256 bits AES256-SHA Accepted TLSv1.2 128 bits ECDHE-RSA-AES128-SHA256 Curve 25519 DHE 253 Accepted TLSv1.2 128 bits AES128-SHA256 Accepted TLSv1.2 256 bits ECDHE-RSA-AES256-SHA384 Curve 25519 DHE 253 Accepted TLSv1.2 256 bits AES256-SHA256 Server Key Exchange Group(s): TLSv1.3 128 bits secp256r1 (NIST P-256) TLSv1.3 192 bits secp384r1 (NIST P-384) TLSv1.3 260 bits secp521r1 (NIST P-521) TLSv1.3 128 bits x25519 TLSv1.2 128 bits secp256r1 (NIST P-256) TLSv1.2 192 bits secp384r1 (NIST P-384) TLSv1.2 260 bits secp521r1 (NIST P-521) TLSv1.2 128 bits x25519 SSL Certificate: Signature Algorithm: sha256WithRSAEncryption RSA Key Strength: 2048 Subject: withdraw.zksync.io Altnames: DNS:withdraw.zksync.io Issuer: GTS CA 1P5 Not valid before: May 5 18:24:22 2024 GMT Not valid after: Aug 3 19:22:17 2024 GMT [2024-05-26 05:55:43.764493] Completed scanning URL: https://withdraw.zksync.io [2024-05-26 05:55:43.764600] Scanning URL: https://checkout.zksync.io/link [2024-05-26 05:55:43.764657] Running Nmap scan on https://checkout.zksync.io/link Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-26 05:55 UTC Unable to split netmask from target expression: "https://checkout.zksync.io/link" WARNING: No targets were specified, so 0 hosts scanned. Nmap done: 0 IP addresses (0 hosts up) scanned in 0.12 seconds [2024-05-26 05:55:43.899870] Running Nikto scan on https://checkout.zksync.io/link - Nikto v2.1.5 --------------------------------------------------------------------------- + Target IP: 104.18.42.36 + Target Hostname: checkout.zksync.io + Target Port: 443 + Start Time: 2024-05-26 05:55:44 (GMT0) --------------------------------------------------------------------------- + Server: cloudflare + The anti-clickjacking X-Frame-Options header is not present. + Uncommon header 'cf-ray' found, with contents: - + No CGI Directories found (use '-C all' to force check all possible dirs) + 6544 items checked: 4 error(s) and 2 item(s) reported on remote host + End Time: 2024-05-26 06:05:24 (GMT0) (580 seconds) --------------------------------------------------------------------------- + 1 host(s) tested [2024-05-26 06:05:24.935646] Running SSL scan on https://checkout.zksync.io/link ERROR: Invalid target specified. [2024-05-26 06:05:24.937949] Completed scanning URL: https://checkout.zksync.io/link [2024-05-26 06:05:24.938039] Scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit [2024-05-26 06:05:25.548006] Completed scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit [2024-05-26 06:05:25.548128] Scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit/src/circuit.rs [2024-05-26 06:05:25.849368] Completed scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit/src/circuit.rs [2024-05-26 06:05:25.849490] Scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit/src/exit_circuit.rs [2024-05-26 06:05:26.106996] Completed scanning Smart Contract: https://github.com/matter-labs/zksync/tree/master/core/lib/circuit/src/exit_circuit.rs [2024-05-26 06:05:26.107099] Vulnerability scan completed. Resroot@79d893fd8ed0:/app/logs# root@79d893fd8ed0:/app/logs# root@79d893fd8ed0:/app/logs# Is there anything useful for our next trail btw from these scans? # Get current timestamp for unique log file names timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S") # Output file for results output_file = f"/app/logs/vuln_scan_results_{timestamp}.txt" # Create logs directory if not exists os.makedirs("/app/logs", exist_ok=True) # Function to log and print def log_and_print(message): print(message) with open(output_file, "a") as f: f.write(message + "\n") # Function to scan a URL def scan_url(url): log_and_print(f"[{datetime.datetime.now()}] Scanning URL: {url}") # Nmap scan log_and_print(f"[{datetime.datetime.now()}] Running Nmap scan on {url}") subprocess.run(["nmap", "-sS", "-sV", url], stdout=open(output_file, "a"), stderr=subprocess.STDOUT) # Nikto scan log_and_print(f"[{datetime.datetime.now()}] Running Nikto scan on {url}") subprocess.run(["nikto", "-h", url], stdout=open(output_file, "a"), stderr=subprocess.STDOUT) # SSL scan log_and_print(f"[{datetime.datetime.now()}] Running SSL scan on {url}") subprocess.run(["sslscan", url], stdout=open(output_file, "a"), stderr=subprocess.STDOUT) log_and_print(f"[{datetime.datetime.now()}] Completed scanning URL: {url}") # Function to scan a smart contract def scan_smart_contract(url): log_and_print(f"[{datetime.datetime.now()}] Scanning Smart Contract: {url}") # Fetch the smart contract code result = subprocess.run(["curl", "-s", url], capture_output=True, text=True) code = result.stdout # Basic check for known vulnerabilities in the smart contract if "selfdestruct" in code: log_and_print(f"[{datetime.datetime.now()}] Potential issue found: selfdestruct usage") if "tx.origin" in code: log_and_print(f"[{datetime.datetime.now()}] Potential issue found: tx.origin usage") log_and_print(f"[{datetime.datetime.now()}] Completed scanning Smart Contract: {url}") # Scan each URL for url in urls: scan_url(url) # Scan each smart contract for contract in smart_contracts: scan_smart_contract(contract) log_and_print(f"[{datetime.datetime.now()}] Vulnerability scan completed. Results saved to {output_file}") 